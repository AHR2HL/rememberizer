{% extends "base.html" %}

{% block title %}Create Domain{% endblock %}

{% block header_title %}{{ "CREATE NEW DOMAIN" | center_in_box }}{% endblock %}

{% block content %}
<div class="content">
    <h2>&gt; DOMAIN CREATION</h2>

    <div class="tabs" style="margin-bottom: 20px;">
        <button class="tab-btn active" onclick="showTab('form')" id="form-tab-btn">[FORM ENTRY]</button>
        <button class="tab-btn" onclick="showTab('csv')" id="csv-tab-btn">[CSV UPLOAD]</button>
    </div>

    <!-- Form Entry Tab -->
    <div id="form-tab" class="tab-content">
        <form method="POST" action="{{ url_for('teacher.create_domain') }}" class="create-form">
            <input type="hidden" name="upload_method" value="form">

            <div class="form-group">
                <label for="domain_name">Domain Name:</label>
                <input type="text" id="domain_name" name="domain_name" required
                       placeholder="US Presidents" class="form-input" autofocus>
            </div>

            <div class="form-group">
                <label for="field_names">Field Names (comma-separated):</label>
                <input type="text" id="field_names" name="field_names" required
                       placeholder="name, party, years_in_office" class="form-input">
                <div style="margin-top: 5px; font-size: 0.9em; color: #00aa00;">
                    Example: name, party, years_in_office
                </div>
            </div>

            <div class="form-group">
                <label for="facts_json">Facts (JSON array):</label>
                <textarea id="facts_json" name="facts_json" rows="15" required
                          class="form-input" style="font-family: monospace; font-size: 0.9em;">[
  {"name": "George Washington", "party": "None", "years_in_office": "1789-1797"},
  {"name": "John Adams", "party": "Federalist", "years_in_office": "1797-1801"},
  {"name": "Thomas Jefferson", "party": "Democratic-Republican", "years_in_office": "1801-1809"},
  {"name": "Abraham Lincoln", "party": "Republican", "years_in_office": "1861-1865"}
]</textarea>
                <div style="margin-top: 5px; font-size: 0.9em; color: #00aa00;">
                    Format: Array of objects, each with all field names. Minimum 4 facts required.
                </div>
            </div>

            <div class="info-box">
                <p><strong>Requirements:</strong></p>
                <ul style="margin: 10px 0; padding-left: 20px;">
                    <li>Domain name must be unique</li>
                    <li>At least 2 fields required</li>
                    <li>At least 4 facts required (for multiple choice questions)</li>
                    <li>Each fact must have all specified fields</li>
                    <li>Domain will be private to your organization by default</li>
                    <li>You can publish it later to make it available to all teachers</li>
                </ul>
            </div>

            <div class="form-actions">
                <button type="submit" class="submit-button">[CREATE DOMAIN]</button>
                <a href="{{ url_for('teacher.domains') }}" class="home-button" style="margin-left: 15px;">[CANCEL]</a>
            </div>
        </form>
    </div>

    <!-- CSV Upload Tab -->
    <div id="csv-tab" class="tab-content" style="display:none;">
        <form method="POST" action="{{ url_for('teacher.create_domain') }}" enctype="multipart/form-data" class="create-form">
            <input type="hidden" name="upload_method" value="csv">

            <div class="form-group">
                <label for="csv_domain_name">Domain Name:</label>
                <input type="text" id="csv_domain_name" name="domain_name" required
                       placeholder="World Capitals" class="form-input">
            </div>

            <div class="form-group">
                <label for="csv_file">CSV File:</label>
                <input type="file" id="csv_file" name="csv_file" accept=".csv" required
                       class="form-input" style="padding: 10px;">
                <div style="margin-top: 5px; font-size: 0.9em; color: #00aa00;">
                    Select a CSV file with header row (field names) and data rows (facts)
                </div>
            </div>

            <div class="info-box">
                <p><strong>CSV Format:</strong></p>
                <ul style="margin: 10px 0; padding-left: 20px;">
                    <li>First row: Header with field names</li>
                    <li>Remaining rows: Facts data</li>
                    <li>Minimum 4 data rows required</li>
                    <li>All rows must have same number of columns</li>
                </ul>

                <p style="margin-top: 15px;"><strong>Example CSV:</strong></p>
                <pre style="background-color: #1a1a1a; padding: 10px; margin-top: 5px; border: 1px solid #00ff00; font-size: 0.85em;">name,party,years_in_office
George Washington,None,1789-1797
John Adams,Federalist,1797-1801
Thomas Jefferson,Democratic-Republican,1801-1809
Abraham Lincoln,Republican,1861-1865</pre>

                <p style="margin-top: 15px;"><strong>Notes:</strong></p>
                <ul style="margin: 10px 0; padding-left: 20px;">
                    <li>Domain will be private to your organization by default</li>
                    <li>You can publish it later from the domains page</li>
                    <li>Maximum file size: 10MB</li>
                </ul>
            </div>

            <div class="form-actions">
                <button type="submit" class="submit-button">[UPLOAD AND CREATE]</button>
                <a href="{{ url_for('teacher.domains') }}" class="home-button" style="margin-left: 15px;">[CANCEL]</a>
            </div>
        </form>
    </div>
</div>

<script>
function showTab(tabName) {
    // Hide all tabs
    document.getElementById('form-tab').style.display = 'none';
    document.getElementById('csv-tab').style.display = 'none';

    // Remove active class from all buttons
    document.getElementById('form-tab-btn').classList.remove('active');
    document.getElementById('csv-tab-btn').classList.remove('active');

    // Show selected tab
    document.getElementById(tabName + '-tab').style.display = 'block';
    document.getElementById(tabName + '-tab-btn').classList.add('active');
}
</script>

<style>
.tabs {
    display: flex;
    gap: 10px;
}

.tab-btn {
    background-color: #1a1a1a;
    color: #00ff00;
    border: 1px solid #00ff00;
    padding: 10px 20px;
    cursor: pointer;
    font-family: 'Courier New', monospace;
    font-size: 1em;
}

.tab-btn:hover {
    background-color: #2a5a2a;
}

.tab-btn.active {
    background-color: #2a5a2a;
    font-weight: bold;
}

.tab-content {
    margin-top: 20px;
}
</style>

{% endblock %}

{% block footer_text %}Create a new custom domain{% endblock %}
